<Tabs>


  <Tab eventKey="pre-installation" title="Pre-Installation">
    ## Existing Conditions
    <Collapsible header="Existing Conditions">
    The application of air permeable insulation without first air sealing is not an acceptable practice. 
    E.g. just blowing an attic with loose fill fiberglass, cellulose, or mineral wood without first checking 
    air sealing details have been performed is not an acceptable practice. Instead HEAR (50122) requires air 
    sealing efforts to precede insulation work unless the insulation is spray foam. The air sealing and 
    insulation don’t have to be done by the same contractor. While not required, often to achieve comprehensive 
    high quality air sealing, the attic first needs to be cleaned of dust, debris, and/or degraded insulation. 
    Prior to air sealing inspect the attic for damaged or missing framing members, exhaust fans venting to the attic, 
    unsafe wiring, water leaks, mold, poor condition duct work, and old or unsafe HVAC or water heating appliances. 
    Replacing these appliances in the attic afterwards can significantly damage or disturb air sealing and insulation.
    </Collapsible>

    <CheckBox label="What part of the home are you air sealing?" options={['Attic']} default_value={['Attic']} path="airsealing_location" />

    <Radio label="What is the starting air leakage rate for the home before modification?" options={['Don\'t know','CFM at 50Pa']} path="attic_air_leakage_rate" />
    
    <ShowOrHide visible={props.data?.attic_air_leakage_rate === 'CFM at 50Pa'}> 
    <NumberInput label="CFM at 50Pa" min={0} path="air_leakage_cfm50"  />
    <PhotoInput id="cfm50_photo" label="Starting blower door manometer showing the CFM50 value – Photo">
        Take a photo of the manometer showing CFM50 of air leakage before air sealing and insulation work was performed.
    </PhotoInput>
    </ShowOrHide>

    <Select label="What is the existing insulation in the ceiling?" options={["None", "Batt insulation", "Blown-in insulation","Rigid board insulation","Closed cell spray foam insulation","Other"]} path="existing_insulation_type" />

    <NumberInput label="What is the existing insulation R-value in the ceiling?" min={0} path="airsealing_r_value"  />
    
    <GeneralSafetyInput {...props} />

  </Tab>
  
  <Tab eventKey="installation" title="Installation">
  Provide a photo of each detail, skip if the feature is not present the home’s attic.
    <Tabs>
      <Tab eventKey="installation_air_Sealing" title="Installation - Air Sealing">
    
        <PhotoInput id="drywall_to_topplate_photo" label="Drywall to Top Plate – Photo">
          Photo of drywall to top plate seam sealed
        </PhotoInput>
        <PhotoInput id="softfir_air_baffels_photo" label="Softfit Ait Baffles – Photo">
          Photo of soffit air baffles installed blocked with batt insulation and/or air sealed with spray foam
        </PhotoInput>
        <PhotoInput id="leakage_recessed_light_photo" label="Leakage Recessed Light – Photo">
          Photo of a leaky recessed light fixture treatment. 
          Recommended treatments include: 
          * Sealing the leaky recessed light fixture using an airtight recessed light cover from the attic
          * Replacing the bulb and trim from below with an airtight LED retrofit module
        </PhotoInput>
        <PhotoInput id="chimney_dam_photo" label="Chimney Dam – Photo">
          Photo of fire caulking and sheet metal dam around chimney
        </PhotoInput>
        <PhotoInput id="hot_flue_pipe_dam_photo" label="Hot Flue Pipe Dam – Photo">
          Photo of fire caulking and sheet metal dam around hot flue pipes
        </PhotoInput>
        <PhotoInput id="wire_and_penetrations_photo" label="Wire and Pipe Penetrations – Photo">
          Photo of electrical wire and pipe penetrations sealed
        </PhotoInput>
        <PhotoInput id="large_opening_sealed_photo" label="Large Opening Sealed – Photo">
          Photo of large opening such as a dropped soffit, dropped ceiling, or chase sealed with rigid foam and spray foam.
        </PhotoInput>
        <PhotoInput id="duct_boot_to_drywall_photo" label="Duct Boot to Drywall – Photo">
          Photo of duct boot to drywall connection sealed
        </PhotoInput>
        <PhotoInput id="exhaust_fan_sealed_to_drywall_photo" label="Exhaust Fan Sealed to Drywall – Photo">
          Photo of exhaust fan sealed to drywall
        </PhotoInput>
        <PhotoInput id="knee_wall_sealed_photo" label="Knee Walls Sealed – Photo">
          Photo of open back knee walls drywall sealed to studs. Install blocking if missing top or bottom plates. Install joist cavity blocking.
        </PhotoInput>
        <PhotoInput id="knee_wall_enclosed_photo" label="Knee Walls Enclosed – Photo">
          Photo of open back knee wall enclosed with air barrier or foam board
        </PhotoInput>
        <PhotoInput id="skylight_wall_sealed_photo" label="Skylight Walls Sealed – Photo">
          Photo of open back skylight shaft wall drywall air sealed to studs
        </PhotoInput>
        <PhotoInput id="skylight_wall_enclosed_photo" label="Skylight Walls Enclosed – Photo">
          Photo of open back skylight walls enclosed with air barrier or foam board
        </PhotoInput>
        <PhotoInput id="balloon_wall_sealed_photo" label="Balloon Walls Sealed – Photo">
          Photo of balloon framed walls sealed with blocking and spray foam
        </PhotoInput>
        <PhotoInput id="stairwell_wall_sealed_photo" label="Stairwell Wall Sealed – Photo">
          Photo of open back stairwell wall sealed with air barrier or foam board
        </PhotoInput>
        <PhotoInput id="t_g_ceiling_sealed_photo" label="T&G Ceiling Sealed – Photo">
          Photo of tongue and groove ceiling sealed
        </PhotoInput>
        <PhotoInput id="storage_platform_preparation_photo" label="Storage Platform Preparation – Photo">
          Photo of storage platform prepared for blown in insulation using batts as blocking if no insulation underneath
        </PhotoInput>
        <PhotoInput id="overview_of_airsealed_attic_photo" label="Overview of Air Sealed Attic – Photo">
          Overview photo of air sealed attic
        </PhotoInput>
        <PhotoInput id="attic_access_dam_photo" label="Attic Access Dam – Photo">
          Photo of installed and sealed insulation dam around attic access
        </PhotoInput>
        <PhotoInput id="attic_access_weatherstrip_photo" label="Attic Access Weatherstrip – Photo">
          Photo of weatherstrip air sealed attic access
        </PhotoInput>
      </Tab>
      <Tab eventKey="installation_insulation" title="Installation - Insulation">
        <PhotoInput id="insulation_measuring_rulers_photo" label="Insulation Measuring Rulers  – Photo">
            Overview of insulation measuring rulers, one installed every 300 sq. ft. visible 
            from attic entrance (photo taken from attic entrance).     
        </PhotoInput>

        <PhotoInput id="rvalue_table_photo" label="R-value Per Inch  – Photo">
          Photo of insulation bag R-value per inch table        
        </PhotoInput>

        <PhotoInput id="skylight_shaft_photo" label="Skylight Shaft – Photo">
          Photot of skylight shaft insulation detail
        </PhotoInput>

        <PhotoInput id="knee_wall_photo" label="Knee Wall – Photo">
          Photo of knee wall insulation detail    
        </PhotoInput>

        <PhotoInput id="stairwell_wall_photo" label="Stairwell Wall – Photo">
          Photo of stairwell wall insulation detail  
        </PhotoInput>

        <PhotoInput id="storage_platform_photo" label="Storage Platform – Photo">
         Photo of storage platform insulation detail
        </PhotoInput>

        <PhotoInput id="wide_angle_photo" label="Wide Angle – Photo">
          Wide angle photo showing insulation uniformity with the rulers visible
        </PhotoInput>

        <PhotoInput id="attic_door_hatch_photo" label="Attic Door/Hatch - Photo">
          Photo of insulation on attic door/hatch. The insulation applied to the door/hatch should match the R-value of the wall/ceiling respectively.
        </PhotoInput>
      </Tab>
    </Tabs>
  </Tab>  
  <Tab eventKey="post_installation"  title="Post-Installation">
  ## Final Conditions
  <Radio label="What is the air sealing level you have achieved?" options={['Don\'t know','CFM at 50Pa']} path="postinstall_attic_air_leakage_rate" />  
  <ShowOrHide visible={props.data?.postinstall_attic_air_leakage_rate === 'CFM at 50Pa'}> 
  <NumberInput label="CFM at 50Pa" min={0} path="postinstall_air_leakage_cfm50"  />
  <PhotoInput id="postinstall_cfm50_photo" label="Final blower door manometer showing the CFM50 value – Photo">
      Photo of the manometer showing CFM50 of air leakage after air sealing and insulation work was performed
  </PhotoInput>
  </ShowOrHide>
  <Radio label="Is the homeowner aware that combustion safety tests are highly recommended for homes with any gas appliances after air sealing projects are completed?" options={['Yes','No', 'N/A']} path="postinstall_safety_briefing_to_homeowner" />
  <Select label="What R-value was added to the ceiling?" options={["Less than R-30", "R-30","R-49", "R-60","more than R-60"]} path="postinstall_ceiling_r_value" />
  <Select label="What percentage of ceiling area received additional insulation (choose the closest)? " options={["10%","25%","50%","75%","100%"]} path="postinstall_insulated_ceiling_area" />
 
  ## Combustion Appliance Safety Testing
  If the home upgrades will result in a barometric draft controlled or Category I appliances equipped with a draft hood or connected 
  to a natural draft venting system remaining in the conditioned envelope of the home, combustion safety checks are required to be 
  performed at the completion of the project. 
  
  If the tests fail, a combustion air opening connecting the combustion appliance area to the outdoors may need to be added or some other 
  remediation may be required. The combustion safety tests performed and documented in this report follows the ANSI/BPI-1200-S-2017
  Standard Practice for Basic Analysis of Buildings Technical Standard.

  <CombustionApplianceSafetyTests path="postinstall_combustion_safety" />
  
  ## Ventilation
  <Collapsible header="Post-retrofit ASHRAE 62.2 Calculation">
  *	The post-retrofit ventilation calculation can help determine whether mechanical ventilation is needed post air sealing and insulation work.
  *	Consider infiltration credits.
  * The ASHRAE 62.2 standard does not require the installation of a system smaller than 15 CFM (7 L/s)
  </Collapsible>
  <Radio label="Has an ASHRAE 62.2 calculation been performed post-retrofit to ensure proper indoor air quality?" options={['Yes','No']} path="post_retrofit_ashrae_62_2_calculation" />
  ## Project Invoice 
  <PhotoInput id="project_invoice_photo" label="Project Invoice – Photo">
    Take a photo of the project invoice. 
  </PhotoInput>
  </Tab>
 <Tab eventKey="report"  title="Report">
    <PrintSection label="Print Report">
    ---
    # Attic Air Sealing and Insulation Upgrade
    ## Photo Report

    <ProjectInfoReport {...props} />

    ## Existing Conditions

    <p> What part of the home are you air sealing?  <strong> { props.data.airsealing_location ? props.data.airsealing_location : null } </strong> </p>
    <p> What is the starting air leakage rate for the home before modification?  <strong> { props.data.attic_air_leakage_rate ? props.data.attic_air_leakage_rate + ': ' : null } { props.data.attic_air_leakage_rate == 'CFM at 50Pa' ? props.data.air_leakage_cfm50  : null } </strong></p>
    <Photo id="cfm50_photo" label="Starting blower door manometer showing the CFM50 value – Photo">
        Photo of the manometer showing CFM50 of air leakage before air sealing and insulation work was performed
    </Photo>
    <p> What is the existing insulation in the ceiling?  <strong> { props.data.existing_insulation_type ? props.data.existing_insulation_type : null } </strong></p>
    <p> What is the existing insulation R-value in the ceiling?  <strong>{ props.data.airsealing_r_value ? props.data.airsealing_r_value : null } </strong></p>    

    <GeneralSafetyReport {...props} />

    ## Installation - Air Sealing Details

    <Photo id="drywall_to_topplate_photo" label="Drywall to Top Plate – Photo" required>
      Photo of drywall to top plate seam sealed
    </Photo>
    <Photo id="softfir_air_baffels_photo" label="Softfit Ait Baffles – Photo" required>
      Photo of soffit air baffles installed blocked with batt insulation and/or air sealed with spray foam
    </Photo>
    <Photo id="leakage_recessed_light_photo" label="Leakage Recessed Light – Photo" required>
      Photo of a leaky recessed light fixture treatment. 
      Recommended treatments include: 
      * Sealing the leaky recessed light fixture using an airtight recessed light cover from the attic
      * Replacing the bulb and trim from below with an airtight LED retrofit module
    </Photo>
    <Photo id="chimney_dam_photo" label="Chimney Dam – Photo" required>
      Photo of fire caulking and sheet metal dam around chimney
    </Photo>
    <Photo id="hot_flue_pipe_dam_photo" label="Hot Flue Pipe Dam – Photo" required>
      Photo of fire caulking and sheet metal dam around hot flue pipes
    </Photo>
    <Photo id="wire_and_penetrations_photo" label="Wire and Pipe Penetrations – Photo" required>
      Photo of electrical wire and pipe penetrations sealed
    </Photo>
    <Photo id="large_opening_sealed_photo" label="Large Opening Sealed – Photo" required>
      Photo of large opening such as a dropped soffit, dropped ceiling, or chase sealed with rigid foam and spray foam.
    </Photo>
    <Photo id="duct_boot_to_drywall_photo" label="Duct Boot to Drywall – Photo" required>
      Photo of duct boot to drywall connection sealed
    </Photo>
    <Photo id="exhaust_fan_sealed_to_drywall_photo" label="Exhaust Fan Sealed to Drywall – Photo" required>
      Photo of exhaust fan sealed to drywall
    </Photo>
    <Photo id="knee_wall_sealed_photo" label="Knee Walls Sealed – Photo" required>
      Photo of open back knee walls drywall sealed to studs. Install blocking if missing top or bottom plates. Install joist cavity blocking.
    </Photo>
    <Photo id="knee_wall_enclosed_photo" label="Knee Walls Enclosed – Photo" required>
      Photo of open back knee wall enclosed with air barrier or foam board
    </Photo>
    <Photo id="skylight_wall_sealed_photo" label="Skylight Walls Sealed – Photo" required>
      Photo of open back skylight shaft wall drywall air sealed to studs
    </Photo>
    <Photo id="skylight_wall_enclosed_photo" label="Skylight Walls Enclosed – Photo" required>
      Photo of open back skylight walls enclosed with air barrier or foam board
    </Photo>
    <Photo id="balloon_wall_sealed_photo" label="Balloon Walls Sealed – Photo" required>
      Photo of balloon framed walls sealed with blocking and spray foam
    </Photo>
    <Photo id="stairwell_wall_sealed_photo" label="Stairwell Wall Sealed – Photo" required>
      Photo of open back stairwell wall sealed with air barrier or foam board
    </Photo>
    <Photo id="t_g_ceiling_sealed_photo" label="T&G Ceiling Sealed – Photo" required>
      Photo of tongue and groove ceiling sealed
    </Photo>
    <Photo id="storage_platform_preparation_photo" label="Storage Platform Preparation – Photo" required>
      Photo of storage platform prepared for blown in insulation using batts as blocking if no insulation underneath
    </Photo>
    <Photo id="overview_of_airsealed_attic_photo" label="Overview of Air Sealed Attic – Photo" required>
      Overview photo of air sealed attic
    </Photo>
    <Photo id="attic_access_dam_photo" label="Attic Access Dam – Photo" required>
      Photo of installed and sealed insulation dam around attic access
    </Photo>
    <Photo id="attic_access_weatherstrip_photo" label="Attic Access Weatherstrip – Photo" required>
      Photo of weatherstrip air sealed attic access
    </Photo>

    ## Installation - Insulation Details
    <Photo id="insulation_measuring_rulers_photo" label="Insulation Measuring Rulers  – Photo">
        Overview of insulation measuring rulers, one installed every 300 sq. ft. visible 
        from attic entrance (photo taken from attic entrance).     
    </Photo>

    <Photo id="rvalue_table_photo" label="R-value Per Inch  – Photo" required>
    Photo of insulation bag R-value per inch table    
    </Photo>

    <Photo id="skylight_shaft_photo" label="Skylight Shaft – Photo" required>
    Photot of skylight shaft insulation detail
    </Photo>

    <Photo id="knee_wall_photo" label="Knee Wall – Photo" required>
      Photo of knee wall insulation detail     
    </Photo>

    <Photo id="stairwell_wall_photo" label="Stairwell Wall – Photo" required>
    Photo of stairwell wall insulation detail     
    </Photo>

    <Photo id="storage_platform_photo" label="Storage Platform – Photo" required>
    Photo of storage platform insulation detail    
    </Photo>

    <Photo id="wide_angle_photo" label="Wide Angle – Photo" required>
    Wide angle photo showing insulation uniformity with rulers visible
    </Photo>

    <Photo id="attic_door_hatch_photo" label="Attic Door/Hatch - Photo" required>
      Photo of insulation on attic door/hatch. The insulation applied to the door/hatch should match the R-value of the wall/ceiling respectively.
    </Photo>

    ## Final Conditions
    <p> What is the air sealing level you have achieved? <strong>{props.data?.postinstall_attic_air_leakage_rate ? props.data?.postinstall_attic_air_leakage_rate : null}</strong> </p>
    {
    props.data?.postinstall_attic_air_leakage_rate === 'CFM at 50Pa' ? 
    <p> CFM at 50Pa: <strong>{props.data.postinstall_air_leakage_cfm50 ? props.data.postinstall_air_leakage_cfm50 : null}</strong> </p> : null
    }

    <Photo id="postinstall_cfm50_photo" label="Final blower door manometer showing the CFM50 value – Photo">
        Photo of the manometer showing CFM50 of air leakage after air sealing and insulation work was performed
    </Photo>
    <p> Is the homeowner aware that combustion safety tests are highly recommended for homes with any gas appliances after air sealing projects are completed? <strong>{props.data.postinstall_safety_briefing_to_homeowner ? props.data.postinstall_safety_briefing_to_homeowner : null}</strong> </p>
    <p> What R-value was added to the ceiling? <strong>{props.data.postinstall_ceiling_r_value ? props.data.postinstall_ceiling_r_value : null}</strong> </p>
    <p> What percentage of ceiling area received additional insulation? <strong>{props.data.postinstall_insulated_ceiling_area ? props.data.postinstall_insulated_ceiling_area : null}</strong> </p>

    ## Combustion Appliance Safety 
    {
    props.data?.combustion_safety_for_appliance1 ?
    <p>
    <strong>{props.data?.combustion_safety_for_appliance1}</strong><br />
    Does the spillage test(s) pass? <strong> {props.data.postinstall_appliance1_spillage_test ? props.data.postinstall_appliance1_spillage_test : null} </strong><br/>
    Does the gas leak detection test pass? <strong> {props.data.postinstall_appliance1_gasleak_detection_test ? props.data.postinstall_appliance1_gasleak_detection_test : null} </strong><br/>
    Does the ambient CO test pass? <strong> {props.data.postinstall_appliance1_ambient_CO_test ? props.data.postinstall_appliance1_ambient_CO_test : null} </strong><br/>
    Does the undiluted CO test pass? <strong> {props.data.postinstall_appliance1_undiluted_CO_test ? props.data.postinstall_appliance1_undiluted_CO_test : null} </strong><br/>
    </p> 
    : null 
    }

    {
    props.data?.combustion_safety_for_appliance2 ?
    <p>
    <strong>{props.data?.combustion_safety_for_appliance2}</strong><br />
    Does the spillage test(s) pass? <strong> {props.data.postinstall_appliance2_spillage_test ? props.data.postinstall_appliance2_spillage_test : null} </strong><br/>
    Does the gas leak detection test pass? <strong> {props.data.postinstall_appliance2_gasleak_detection_test ? props.data.postinstall_appliance2_gasleak_detection_test : null} </strong><br/>
    Does the ambient CO test pass? <strong> {props.data.postinstall_appliance2_ambient_CO_test ? props.data.postinstall_appliance2_ambient_CO_test : null} </strong><br/>
    Does the undiluted CO test pass? <strong> {props.data.postinstall_appliance2_undiluted_CO_test ? props.data.postinstall_appliance2_undiluted_CO_test : null} </strong><br/>
    </p> 
    : null 
    }

    ## Ventilation
    <p> Has an ASHRAE 62.2 calculation been performed post-retrofit to ensure proper indoor air quality?  { props.data.post_retrofit_ashrae_62_2_calculation ? props.data.post_retrofit_ashrae_62_2_calculation : null } </p>

    ## Project Invoice
    <Photo id="project_invoice_photo" label="Project Invoice – Photo" required>
      Photo of the project invoice
    </Photo>


    </PrintSection>
  </Tab>
</Tabs>